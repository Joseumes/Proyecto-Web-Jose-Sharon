CREATE DATABASE IF NOT EXISTS Hotel_Paraiso;
USE Hotel_Paraiso;

-- Tabla: USUARIO
CREATE TABLE IF NOT EXISTS USUARIO (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    USERNAME VARCHAR(50) NOT NULL UNIQUE,
    CONTRASEÑA VARCHAR(255) NOT NULL,
    NOMBRE VARCHAR(100) NOT NULL,
    ROL ENUM('admin', 'recepcion') DEFAULT 'recepcion'
);

-- Insertar usuario por defecto (login inicial)
INSERT INTO USUARIO (USERNAME, CONTRASEÑA, NOMBRE, ROL)
VALUES ('admin', 'admin', 'Administrador', 'admin');

-- Tabla: CLIENTE
CREATE TABLE IF NOT EXISTS CLIENTE (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE VARCHAR(100) NOT NULL,
    NIT VARCHAR(20) NOT NULL,
    FECHA_NACIMIENTO DATE NOT NULL,
    TELEFONO VARCHAR(15),
    EMAIL VARCHAR(100),
    DIRECCION TEXT,
    FECHA_REGISTRO DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- Tabla: HABITACION
CREATE TABLE IF NOT EXISTS HABITACION (
    NUMERO INT PRIMARY KEY,
    ESTADO ENUM('disponible', 'ocupada') DEFAULT 'disponible',
    DISTANCIA_SALIDA INT NOT NULL COMMENT 'Distancia en metros a la salida principal'
);

-- Insertar habitaciones predeterminadas
INSERT INTO HABITACION (NUMERO, DISTANCIA_SALIDA) VALUES
(1, 10), (2, 20), (3, 30), (4, 40),
(5, 50), (6, 60), (7, 70), (8, 80);

-- Tabla: SERVICIO
CREATE TABLE IF NOT EXISTS SERVICIO (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE VARCHAR(50) NOT NULL,
    PRECIO DECIMAL(10,2) NOT NULL
);

-- Insertar servicios predeterminados
INSERT INTO SERVICIO (NOMBRE, PRECIO) VALUES
('Desayuno', 30.00),
('Almuerzo', 65.00),
('Cena', 75.00),
('Masaje', 150.00),
('Spa', 300.00);

-- Tabla: RESERVA
CREATE TABLE IF NOT EXISTS RESERVA (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE VARCHAR(100) NOT NULL,
    NIT VARCHAR(20) NOT NULL,
    FECHA_NACIMIENTO DATE NOT NULL,
    TELEFONO VARCHAR(15) NOT NULL,
    FECHA_INGRESO DATE NOT NULL,
    FECHA_SALIDA DATE NOT NULL,
    ESTADO ENUM('pendiente', 'confirmada', 'cancelada') DEFAULT 'pendiente',
    FECHA_CREACION DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- Tabla: HOSPEDAJE
CREATE TABLE IF NOT EXISTS HOSPEDAJE (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    ID_CLIENTE INT NOT NULL,
    NUMERO_HABITACION INT NOT NULL,
    FECHA_CHECKIN DATETIME DEFAULT CURRENT_TIMESTAMP,
    FECHA_CHECKOUT DATETIME DEFAULT NULL,
    TOTAL_PAGADO DECIMAL(10,2) DEFAULT 0.00,
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID),
    FOREIGN KEY (NUMERO_HABITACION) REFERENCES HABITACION(NUMERO)
);

-- Tabla: CLIENTESERVICIO
CREATE TABLE IF NOT EXISTS CLIENTESERVICIO (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    ID_HOSPEDAJE INT NOT NULL,
    ID_SERVICIO INT NOT NULL,
    CANTIDAD INT DEFAULT 1,
    FECHA DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (ID_HOSPEDAJE) REFERENCES HOSPEDAJE(ID),
    FOREIGN KEY (ID_SERVICIO) REFERENCES SERVICIO(ID)
);
